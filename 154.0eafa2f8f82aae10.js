"use strict";(self.webpackChunkFrontend=self.webpackChunkFrontend||[]).push([[154],{9154:(F,p,c)=>{c.r(p),c.d(p,{HistoryDetailsModule:()=>G});var g=c(6814),u=c(1567),C=c(4338),h=c(9207),x=c(4874),t=c(5879),Z=c(3094),_=c(7337),T=c(9862);let M=(()=>{class a{constructor(e){this.http=e}getDatos(e){return this.http.get(`${_.N.baseUrl}datos/${e}`)}getConteos(e){return this.http.get(`${_.N.baseUrl}conteo/${e}`)}getHV(e){return this.http.get(`${_.N.baseUrl}total/${e}`)}getUserId(e){return this.http.get(`${_.N.baseUrl}userID/${e}`)}editConteos(e,o){return this.http.put(`${_.N.baseUrl}conteo/${e}`,o)}editDatos(e,o){return this.http.put(`${_.N.baseUrl}datos/${e}`,o)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(T.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var D=c(3460),H=c(833),l=c(7983),d=c(95),m=c(6068),f=c(6819);function y(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"td",7),t._uU(2),t.qZA(),t.TgZ(3,"td",7),t._uU(4),t.qZA(),t.TgZ(5,"td",7),t._uU(6),t.qZA(),t.TgZ(7,"td",7),t._uU(8),t.qZA(),t.TgZ(9,"td",7),t._uU(10),t.qZA(),t.TgZ(11,"td",14)(12,"a",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.startEdit(n.id,"general"))}),t._uU(13,"Editar"),t.qZA()(),t.BQk()}if(2&a){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.cepa),t.xp6(2),t.Oqu(e.generacion),t.xp6(2),t.Oqu(e.codigo_crianza),t.xp6(2),t.Oqu(e.especie),t.xp6(2),t.Oqu(e.total_huevos_intactos)}}function A(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td")(1,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache[i.id].data.cepa=n)}),t.qZA()(),t.TgZ(2,"td")(3,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache[i.id].data.generacion=n)}),t.qZA()(),t.TgZ(4,"td")(5,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache[i.id].data.codigo_crianza=n)}),t.qZA()(),t.TgZ(6,"td")(7,"input",17),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache[i.id].data.especie=n)}),t.qZA(),t.TgZ(8,"datalist",18),t._UZ(9,"option",19)(10,"option",20)(11,"option",21)(12,"option",22)(13,"option",23)(14,"option",24)(15,"option",25)(16,"option",26),t.qZA()(),t.TgZ(17,"td",7),t._uU(18),t.qZA(),t.TgZ(19,"td",7)(20,"a",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.saveEdit(n.id,"general"))}),t._uU(21," Guardar"),t.qZA(),t.TgZ(22,"a",28),t.NdJ("nzOnConfirm",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.cancelEdit(n.id,"general"))}),t._uU(23,"Cancelar"),t.qZA()()}if(2&a){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngModel",o.editCache[e.id].data.cepa),t.xp6(2),t.Q6J("ngModel",o.editCache[e.id].data.generacion),t.xp6(2),t.Q6J("ngModel",o.editCache[e.id].data.codigo_crianza),t.xp6(2),t.Q6J("ngModel",o.editCache[e.id].data.especie),t.xp6(11),t.Oqu(e.total_huevos_intactos)}}function v(a,r){if(1&a&&(t.TgZ(0,"tr"),t.YNc(1,y,14,5,"ng-container",12),t.YNc(2,A,24,5,"ng-template",null,13,t.W1O),t.qZA()),2&a){const e=r.$implicit,o=t.MAs(3),n=t.oxw();t.xp6(1),t.Q6J("ngIf",!n.editCache[e.id].edit)("ngIfElse",o)}}function O(a,r){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"td",7),t._uU(2),t.qZA(),t.TgZ(3,"td",7),t._uU(4),t.qZA(),t.TgZ(5,"td",7),t._uU(6),t.qZA(),t.TgZ(7,"td",7),t._uU(8),t.qZA(),t.TgZ(9,"td",7),t._uU(10),t.qZA(),t.TgZ(11,"td",7),t._uU(12),t.qZA(),t.TgZ(13,"td",7),t._uU(14),t.qZA(),t.TgZ(15,"td",7),t._uU(16),t.qZA(),t.TgZ(17,"td",7),t._uU(18),t.qZA(),t.TgZ(19,"td",14)(20,"a",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.startEdit(n.id,"conteo"))}),t._uU(21,"Editar"),t.qZA()(),t.BQk()}if(2&a){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.codigo_sustrato),t.xp6(2),t.Oqu(e.fecha_colocacion),t.xp6(2),t.Oqu(e.fecha_retiro),t.xp6(2),t.Oqu(e.huevos_intactos),t.xp6(2),t.Oqu(e.huevos_eclosionados),t.xp6(2),t.Oqu(e.huevos_canoa),t.xp6(2),t.Oqu(e.total_huevos),t.xp6(2),t.Oqu(e.generacion),t.xp6(2),t.Oqu(e.responsable)}}function q(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"td")(1,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.codigo_sustrato=n)}),t.qZA()(),t.TgZ(2,"td")(3,"nz-date-picker",30),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.fecha_colocacion=n)})("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onDateChange(i.id,n,"fecha_colocacion"))}),t.qZA()(),t.TgZ(4,"td")(5,"nz-date-picker",30),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.fecha_retiro=n)})("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onDateChange(i.id,n,"fecha_retiro"))}),t.qZA()(),t.TgZ(6,"td")(7,"input",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.huevos_intactos=n)}),t.qZA()(),t.TgZ(8,"td")(9,"input",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.huevos_eclosionados=n)}),t.qZA()(),t.TgZ(10,"td")(11,"input",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.huevos_canoa=n)}),t.qZA()(),t.TgZ(12,"td")(13,"input",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.total_huevos=n)}),t.qZA()(),t.TgZ(14,"td")(15,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.generacion=n)}),t.qZA()(),t.TgZ(16,"td")(17,"input",16),t.NdJ("ngModelChange",function(n){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.editCache2[i.id].data.responsable=n)}),t.qZA()(),t.TgZ(18,"td",7)(19,"a",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.saveEdit(n.id,"conteo"))}),t._uU(20," Guardar"),t.qZA(),t.TgZ(21,"a",28),t.NdJ("nzOnConfirm",function(){t.CHM(e);const n=t.oxw().$implicit,i=t.oxw();return t.KtG(i.cancelEdit(n.id,"conteo"))}),t._uU(22,"Cancelar"),t.qZA()()}if(2&a){const e=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngModel",o.editCache2[e.id].data.codigo_sustrato),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.fecha_colocacion),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.fecha_retiro),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.huevos_intactos),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.huevos_eclosionados),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.huevos_canoa),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.total_huevos),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.generacion),t.xp6(2),t.Q6J("ngModel",o.editCache2[e.id].data.responsable)}}function z(a,r){if(1&a&&(t.TgZ(0,"tr"),t.YNc(1,O,22,9,"ng-container",12),t.YNc(2,q,23,9,"ng-template",null,29,t.W1O),t.qZA()),2&a){const e=r.$implicit,o=t.MAs(3),n=t.oxw();t.xp6(1),t.Q6J("ngIf",!n.editCache2[e.id].edit)("ngIfElse",o)}}const U=function(){return{x:"1500px"}},w=function(){return{x:"2000px"}},J=[{path:"",component:(()=>{class a{startEdit(e,o){"general"===o?this.editCache[e].edit=!0:"conteo"===o&&(this.editCache2[e].edit=!0)}onDateChange(e,o,n){if("fecha_colocacion"===n)if(o&&(0,C.Z)(o)){const i=(0,h.Z)(o,"yyyy-MM-dd");this.editCache2[e].data.fecha_colocacion=i}else this.editCache2[e].data.fecha_colocacion=(0,h.Z)(new Date,"yyyy-MM-dd");else if("fecha_retiro"===n)if(o&&(0,C.Z)(o)){const i=(0,h.Z)(o,"yyyy-MM-dd");this.editCache2[e].data.fecha_retiro=i}else this.editCache2[e].data.fecha_retiro=(0,h.Z)(new Date,"yyyy-MM-dd")}cancelEdit(e,o){if("general"===o){const n=this.listOfData.findIndex(i=>i.id===e);this.editCache[e]={data:{...this.listOfData[n]},edit:!1}}else if("conteo"===o){const n=this.listOfData2.findIndex(i=>i.id===e);this.editCache2[e]={data:{...this.listOfData2[n]},edit:!1}}}saveEdit(e,o){if("general"===o){const n=this.listOfData.findIndex(i=>i.id===e);Object.assign(this.listOfData[n],this.editCache[e].data),this.editCache[e].edit=!1,this.saveDatos(this.listOfData[n].id,this.listOfData[n])}else if("conteo"===o){const n=this.listOfData2.findIndex(i=>i.id===e);Object.assign(this.listOfData2[n],this.editCache2[e].data),this.editCache2[e].edit=!1,this.saveConteos(this.listOfData2[n].id,this.listOfData2[n])}console.log(this.listOfData2)}updateEditCache(){this.listOfData.forEach(e=>{this.editCache[e.id]={edit:!1,data:{...e}}}),this.listOfData2.forEach(e=>{this.editCache2[e.id]={edit:!1,data:{...e}}})}getDatos(){this.loading2=!0,this.service.getDatos(this.idDatos).subscribe(e=>{console.log("DATOS:",e),this.listOfData=e,this.getTotalHV(),console.log("CACHE 1:",this.editCache),this.updateEditCache(),this.loading2=!1})}getTotalHV(){this.service.getHV(this.idDatos).subscribe(e=>{console.log("TOTAL_HV:",e),this.listOfData[0].total_huevos_intactos=e[0].HV})}getConteos(){this.loading=!0,this.service.getConteos(this.idDatos).subscribe(e=>{console.log("CONTEOS:",e),this.listOfData2=e,console.log("LISTA CONTEO:",this.listOfData2),console.log("CACHE 2:",this.editCache2),this.updateEditCache(),this.loading=!1})}saveConteos(e,o){console.log("ID",e),console.log("data",o),this.service.editConteos(e,o).subscribe({next:n=>{console.log("bueno",n),this.message.create("success","Datos guardados con \xe9xito")},error:n=>{console.log("malo",n),this.message.create("error",n.error.error)}})}saveDatos(e,o){console.log("ID",e),console.log("data",o),this.service.editDatos(e,o).subscribe({next:n=>{console.log("bueno",n),this.message.create("success","Datos guardados con \xe9xito")},error:n=>{console.log("malo",n),this.message.create("error",n.error.error)}})}constructor(e,o,n,i){this.i18n=e,this.service=o,this.route=n,this.message=i,this.date=null,this.listOfData=[],this.listOfData2=[],this.editCache={},this.editCache2={},this.idDatos=0,this.loading=!0,this.loading2=!0,this.uid=null}ngOnInit(){this.route.params.subscribe(o=>{const n=+o.id;console.log(n),this.idDatos=n}),(0,x.v0)().onAuthStateChanged(o=>{o?(this.uid=o.uid,console.log("UID",this.uid)):console.log("No user is signed in.")}),this.getDatos(),this.getConteos()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z.wi),t.Y36(M),t.Y36(u.gz),t.Y36(D.dD))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-history-details"]],decls:54,vars:11,consts:[[1,"container-fluid","color",2,"min-height","100%"],[1,"container",2,"padding-bottom","10px","padding-top","100px"],[2,"height","100%"],[1,"text-center",2,"margin-bottom","50px","color","#f2f9f1"],["nzTableLayout","fixed",3,"nzScroll","nzData","nzShowPagination","nzLoading"],["editRowTable","","basicTable",""],[1,"custom-header"],["nzAlign","center"],[1,"custom-body"],[4,"ngFor","ngForOf"],["nzShowSizeChanger","","nzTableLayout","fixed",3,"nzScroll","nzData","nzLoading"],["basicTable2",""],[4,"ngIf","ngIfElse"],["editTemplateGeneral",""],["nzAlign","center",2,"font-weight","bold","color","#388e3c"],[3,"click"],["type","text","nz-input","",3,"ngModel","ngModelChange"],["list","especies","type","text","nz-input","",3,"ngModel","ngModelChange"],["id","especies"],["value","Aedes aegypti"],["value","Aedes albopictus"],["value","Anopheles gambiae"],["value","Anopheles stephensi"],["value","Anopheles funestus"],["value","Culex pipiens"],["value","Culex tarsalis"],["value","Culex quinquefasciatus"],[2,"margin-right","10px","font-weight","bold","color","#388e3c",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Seguro?",2,"font-weight","bold","color","#388e3c",3,"nzOnConfirm"],["editTemplateHuevecillos",""],[3,"ngModel","ngModelChange"],["type","number","nz-input","",3,"ngModel","ngModelChange"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"app-navbar"),t.TgZ(3,"div",2)(4,"h1",3),t._uU(5," Datos Generales "),t.qZA(),t.TgZ(6,"nz-table",4,5)(9,"thead")(10,"tr",6)(11,"th",7),t._uU(12,"Cepa"),t.qZA(),t.TgZ(13,"th",7),t._uU(14,"Generaci\xf3n"),t.qZA(),t.TgZ(15,"th",7),t._uU(16,"C\xf3digo Crianza"),t.qZA(),t.TgZ(17,"th",7),t._uU(18,"Especie"),t.qZA(),t.TgZ(19,"th",7),t._uU(20,"Total Huevos Viables"),t.qZA(),t.TgZ(21,"th",7),t._uU(22,"Acci\xf3n"),t.qZA()()(),t.TgZ(23,"tbody",8),t.YNc(24,v,4,2,"tr",9),t.qZA()(),t._UZ(25,"br"),t.TgZ(26,"h1",3),t._uU(27," Conteo de Huevecillos "),t.qZA(),t.TgZ(28,"nz-table",10,11)(30,"thead")(31,"tr",6)(32,"th",7),t._uU(33,"C\xf3digo Sustrato"),t.qZA(),t.TgZ(34,"th",7),t._uU(35,"Fecha Colocaci\xf3n Sustrato"),t.qZA(),t.TgZ(36,"th",7),t._uU(37,"Fecha Retiro Sustrato"),t.qZA(),t.TgZ(38,"th",7),t._uU(39,"Huevos Viables"),t.qZA(),t.TgZ(40,"th",7),t._uU(41,"Huevos Eclosionados"),t.qZA(),t.TgZ(42,"th",7),t._uU(43,"Huevos en Canoa"),t.qZA(),t.TgZ(44,"th",7),t._uU(45,"Total de Huevos"),t.qZA(),t.TgZ(46,"th",7),t._uU(47,"Generacion Filial"),t.qZA(),t.TgZ(48,"th",7),t._uU(49,"Responsable Conteo Huevos"),t.qZA(),t.TgZ(50,"th",7),t._uU(51,"Acci\xf3n"),t.qZA()()(),t.TgZ(52,"tbody",8),t.YNc(53,z,4,2,"tr",9),t.qZA()()()()()),2&e){const n=t.MAs(8),i=t.MAs(29);t.xp6(6),t.Q6J("nzScroll",t.DdM(9,U))("nzData",o.listOfData)("nzShowPagination",!1)("nzLoading",o.loading2),t.xp6(18),t.Q6J("ngForOf",n.data),t.xp6(4),t.Q6J("nzScroll",t.DdM(10,w))("nzData",o.listOfData2)("nzLoading",o.loading),t.xp6(25),t.Q6J("ngForOf",i.data)}},dependencies:[g.sg,g.O5,H.S,l.N8,l.Uo,l._C,l.Om,l.p0,l.$Z,l.UX,d.YN,d.Kr,d.Fj,d.wV,d.JJ,d.On,m.JW,f.uw],styles:['@charset "UTF-8";.color[_ngcontent-%COMP%]{background-color:#8bc34a}.custom-header[_ngcontent-%COMP%]{background-color:#388e3c}.custom-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#388e3c;color:#f2f9f1}.custom-body[_ngcontent-%COMP%]{background-color:#ddeedf}.table-container[_ngcontent-%COMP%]{overflow-x:auto;width:100%}']}),a})()}];let $=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[u.Bz.forChild(J),u.Bz]}),a})();var b=c(2552),N=c(6161),E=c(6828);(0,g.qS)(E.Z);let G=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[g.ez,$,b.m,l.HQ,N.uK,d.u5,m._p,f.Hb]}),a})()}}]);